sudo: required
language: python
python:
    - "2.7"
env:
    - CKANVERSION=2.5 PGVERSION=9.1
install:
    - bash bin/travis-build.bash
services:
    - redis-server
before_script:
  - "sudo add-apt-repository --remove 'http://us-central1.gce.archive.ubuntu.com/ubuntu/ main restricted'"
  - "sudo add-apt-repository --remove 'http://us-central1.gce.archive.ubuntu.com/ubuntu/ universe'"
  - "sudo add-apt-repository --remove 'http://us-central1.gce.archive.ubuntu.com/ubuntu/ multiverse'"
  - "sudo add-apt-repository http://archive.ubuntu.com/ubuntu/"
  - "sudo add-apt-repository 'http://archive.ubuntu.com/ubuntu/ universe'"
  - "sudo add-apt-repository 'http://archive.ubuntu.com/ubuntu/ multiverse'"
  - "sudo apt-get -qq --fix-missing update"
script: sh bin/travis-run.sh
before_install:
    - pip install codecov
after_success:
    - codecov
